<html>  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <meta name="KeyWords" content="Cormas, Cirad, gestion des ressources naturelles, natural resource management, INRM, environnement, environment, simulation, modelisation, modelling, SMA, MAS, multi-agent, smalltalk, visualworks, logiciel, software">    <title>demo_Aquifer</title>    <!--#include virtual="/include/script.inc" -->    <link rel="stylesheet" href="/css/cormas.css" --="">    <script type="text/javascript" src="../js/mathjax/MathJax.js?config=AM_HTMLorMML-full"></script> </head>  <body topmargin="0" leftmargin="0" border="0" onload="MM_preloadImages('/images/en/accueil_r.gif','/images/en/demarche_r.gif','/images/en/logiciel_r.gif','/images/en/applications_r.gif','/images/en/biblio_r.gif','/images/en/formation_r.gif','/images/en/reseaux_r.gif')"    style="        background-color: white;"    marginheight="0"    marginwidth="0">    <!--#include virtual="haut.inc" -->    <table border="0" cellpadding="0" cellspacing="0" width="100%">      <tbody>        <tr>          <!--#include virtual="sommair.inc" -->          <td bgcolor="#FFFFFF" valign="top" width="*">            <p>&nbsp;</p>            <h1>Demo_Aquifer: the ground water diffusion in an aquifer</h1>            <b>Pierre Bommel,&nbsp; Bruno Bonté, Marie-Paule Bonnet, Grégoire              Leclerc.</b><br>            <br>            The aim of this model (<a href="../../logiciel/Demo_Aquifer.zip">zipfile</a>,            191Ko) is to simulate water exchange between surface soil, river            network and the underlying aquifer. <br>            This model is a replication of the model by (<a href="#reference">Ravazzani
              et al. 2011</a>) called MACCA-GW (for MACroscopic Cellular            Automata for GroundWater). <br>            It represents the water flow in unconfined aquifers. The model is            based on a uniform regular lattice, that discretizes the water flow            in space and time. <br>            Many complex macroscopic fluid dynamical phenomena seem difficult to            be modelled by cellular automata, because they take place on a large            space scale and require a macroscopic level of description. <br>            <br>            <img alt="fig ANdrimont 1910" src="../../images/applica/aquifer/Andrimont1910.png"><br>            <address>Groundwater flow systems; picture presented at the Brussels              World Exhibition in 1910 by René d’Andrimont (from Jacobus J. de              Vries in<span style="color: #0000ee;"> </span><a href="#Delleur">Delleur
                1998</a>).</address>            <br>            The Demo_Aquifer model focuses only on unconfined aquifer: case <i>b</i>            of the following figure:<br>            <br>            <table style="width: 100%;" border="0">              <tbody>                <tr>                  <td><img alt="confined" src="../../images/applica/aquifer/confined.png"><br>                  </td>                  <td><img alt="unconfined" src="../../images/applica/aquifer/unconfined.png"><br>                  </td>                </tr>              </tbody>            </table>            <br>            <address>Kinds of aquifers. (a) Confined aquifer; (b) unconfined              aquifer. (from<span style="color: #0000ee;"> </span><a href="file:///Users/bommel/CormasWeb/en/applica/demoAquifer.html#Delleur">Delleur
                1998</a>). The Demo_aquifer model refers only on the unconfined              aquifer (b).</address>            <address> </address>            <h2>The physical model based on the Darcy's law (1856)</h2>            <!--EndFragment--><img alt="Darcy Law" src="../../images/applica/aquifer/DarcyLaw.png"><br>            <address>Figure illustrating tube experiments of Henri Darcy (from<span                style="color: #0000ee;">              </span><a href="file:///Users/bommel/CormasWeb/en/applica/demoAquifer.html#Delleur">Delleur
                1998</a>). </address>            <br>            <meta charset="utf-8">            The Darcy equation is:<br>            <dl>              <dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y"                    style="display: none;"><math                      xmlns="http://www.w3.org/1998/Math/MathML"                      alttext="{\displaystyle Q=KA{\frac {\Delta H}{L}}}">                      <semantics>                        <mrow class="MJX-TeXAtom-ORD">                          <mstyle displaystyle="true" scriptlevel="0">                            <mi>Q</mi>                            <mo>=</mo>                            <mi>K</mi>                            <mi>A</mi>                            <mrow class="MJX-TeXAtom-ORD">                              <mfrac>                                <mrow>                                  <mi mathvariant="normal">Δ<!-- Δ --></mi>                                  <mi>H</mi> </mrow>                                <mi>L</mi> </mfrac> </mrow> </mstyle> </mrow>                        <annotation encoding="application/x-tex">{\displaystyle                          Q=KA{\frac {\Delta H}{L}}}</annotation> </semantics>                    </math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b35837685cc0cb26c57d645c41dbd016af40bfc1"                    class="mwe-math-fallback-image-inline"                    aria-hidden="true"                    style="vertical-align: -1.838ex; width:13.581ex; height:5.343ex;"                    alt="Q=KA{\frac  {\Delta H}{L}}"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                &nbsp; &nbsp; &nbsp;&nbsp; (eq. 1)</dd>            </dl>            <p>where :</p>            <ul>              <li>Q : the volumetric flow rate (m<sup>3</sup>/s).</li>              <li>K : the hydraulic "conductivity" or "permeability coefficient"                of the porous medium (m/s), which depends on both the properties                of the porous medium and the viscosity of the fluid.</li>              <li>A : the area of the section (m<sup>2</sup>)</li>              <li>ΔH is the difference between upstream and downstream                piezometric heights (<i>i</i> = ΔH/L is the hydraulic gradient)</li>              <li>L is the length of the sample.</li>            </ul>            The Demo_Aquifer model differentiates the flows (sources + or sinks            -) into two parts: (1) lateral water diffusion and (2) vertical            water fluxes:<br>            <br>            (a) <img alt="Von Neumann" src="../../images/applica/aquifer/neumann.png">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            (b)&nbsp; <img alt="flow between 2 cells" src="../../images/applica/aquifer/2cells.png"><br>            <br>            <address>(a) Scheme for the calculation of water fluxes between a              central cell and its four adjacent cells. Qnc is the latteral flux              coming from the northern cell, for example. Wc is the vertical              flux representing source or sink (from <a href="Ravazzani,%20G.,%20Rametta,%20D.,%20&amp;%20Mancini,%20M.,%202011">Ravazzani
                et al. 2011</a>). (b) flow between 2 cells. </address>            <br>            Then the total incoming or outgoing flow is:<br>            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Q<sub>C</sub> = Q<sub>NC</sub>            + Q<sub>EC</sub> + Q<sub>SC</sub> + Q<sub>WC</sub> + W<sub>C</sub>&nbsp;&nbsp;&nbsp;&nbsp;
            in [L<sup>3</sup> T<sup>-1</sup>],&nbsp;&nbsp;&nbsp; where            <ul>              <li>Q<sub>NC</sub> + Q<sub>EC</sub> + Q<sub>SC</sub> + Q<sub>WC</sub>                represent the <i>lateral water diffusion</i>, and </li>              <li>W<sub>C</sub> , the <i>vertical water flows</i> with the                ground due to pumping wells (-) or recharge (+) by rain, river                or lake.</li>            </ul>            According to Darcy equation (eq. 1), the water flux between central            cell and, for example, northern cell, Q<sub>NC</sub> is calculated            as:<br>            <img alt="Qnc=(2TnTc)/(Tn+Tc) . (Hn-Hc)" src="../../images/applica/aquifer/equation1.png">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            (eq. 2)<br>            where:<br>            <ul>              <li><i>T</i><sub>N</sub> and <i>T</i><sub>C</sub> represent,                respectively, the <i>transmissivity</i> [L<sup>2</sup> T<sup>-1</sup>]                of northern cell and central cell, </li>              <li><i>h</i><sup>t</sup><sub>N</sub> and <i>h</i><sup>t</sup><sub>C</sub>                represent, respectively, hydraulic head of northern cell and                central cell at previous time step, <i>t</i>.</li>            </ul>            <!--EndFragment-->The flux <i>Q<sub>NC</sub></i> is positive if            water is entering the central cell.<br>            In Demo_Aquifer, the <i> Transmitivity</i> of a cell <i>C</i> is            calculated as:<br>            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>T</i><sub>C</sub> = <i>K</i><sub>C</sub>            . <i>Z</i><sub>C</sub> &nbsp;&nbsp;&nbsp; <br>            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where . <i>Z</i><sub>C</sub> is the            <i>thickness</i> = (head - base) of the cell.<br>            <br>            The term 2T<sub>N</sub>T<sub>C</sub> /(T<sub>N</sub> + T<sub>C</sub>)            is the harmonic mean of transmissivity. It has been chosen because            of its property to remove the impacts of large outliers by limiting            the flux to the lower value of transmissivity. <br>            <h3>The Reynolds number for determining the time step value</h3>            Darcy's law is only valid for slow, viscous flow as it is the case            of most groundwater flows. Typically any flow with a Reynolds number            less than 1 is clearly laminar, and it would be valid to apply            Darcy's law. Experimental tests have shown that flow regimes with            Reynolds numbers up to 10 may still be Darcian, as in the case of            groundwater flow. The Reynolds number <i>D</i> (a dimensionless            parameter) for porous media flow is defined as the ratio of physical            and numerical diffusivities:<br>            <img alt="Reynolds nb" src="../../images/applica/aquifer/Reynolds%20number.png">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (eq. 3)<br>            where :            <ul>              <li>ν is the hydraulic diffusivity of the aquifer. ν = = K.Z/S, in                [L<sup>2</sup>/T] (= Transmissivity / storativity = conductivity                . thickness / storativity)</li>              <li>(Δ<i>s</i>)<sup>2</sup> is the area of the cell [L<sup>2</sup>]</li>              <li>Δ<i>t</i><sup></sup> is the time step [T]</li>            </ul>            If we fix D = 1 to get stability, then the time step duration should            be:<br>            <img alt="deltaT" src="../../images/applica/aquifer/deltaT.png">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            (eq. 4)<br>            So, in order to have smooth water movements, the model must first            determine the duration of delta t, the minimum time step.<br>            <br>            After calculating the diffusion flows between the cells, the            hydraulic head of each cell is updated for the subsequent time step            (t + Δ<i>t</i>), applying the discrete mass balance equation:<br>            <br>            <img alt="Ht+1=Ht + 1/S . Q/area . dt" src="../../images/applica/aquifer/equation2.png">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            (eq. 5)<br>            where:<br>            <ul>              <li>S<sub>y</sub> represents the storativity (porosity) of the                cell [dimensionless]</li>            </ul>            <h2> Model description and results</h2>            <p>The first version of the model (Demo_Aquifer.pcl) is a simple              cellular automata (with one class: Plot). The main attributes of              Plot are: storativity, head, base, conductivity and sideLength,              then altitude base volume hasConstantHead dailyFluxWithSurface.<br>              After initializing the model and calculating the delta value              (according to eq. 4), a dailyStep can be run. In #dailyStep, water              dynamic is executed X times/day:</p>            <pre>&nbsp;&nbsp;&nbsp; rep := 24 * 3600 / Demo_Aquifer deltaT.<br>&nbsp;&nbsp;&nbsp; rep &gt;= 1<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ifTrue:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [rep rounded timesRepeat:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [self thePlots do: [:p | p setAllVolumetricFluxes].<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; self thePlots do: [:p | p calculateHead]]]</pre><p>Here, the transition function of the CA is called #setAllVolumetricFluxes. Instead of having 'state' and 'bufferState', the cells use head (as 'state') and volume (as the bufferState). <br>So, the model calculates the diffusion of water (Q) from each cell towards its surrounded cells (or the reverse). <br>The latteralFlux is then multiplicated by Δ<i>t</i>, the step duration, in order to pass from m<sup>3</sup>/s to m<sup>3</sup>/Δ<i>t</i> as shown in the #lateralWaterDiffusion method of Plot:</p><pre><b>lateralWaterDiffusion</b><br>"Purpose: This is the transition function of the Cellular Automata. Flux between 2 cells is calculated as:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Fn,c = 2.T n.Tc/(Tn+Tc) . (Hn - Hc)<br>with T = Transmitivity = conductivity *&nbsp; thickness"<br>&nbsp;&nbsp;&nbsp; <br><imgalt="code of diffusion"src="../../images/applica/aquifer/codeDiffusion.png"></pre>This way of doing is similar for the other flows.<br>Then the #calculateHead method is called for each cell in order to set the new head of the cells, according to eq. 5. (#calculateHead is equivalent to the #updateState method for standard CA)<spanstyle="font-family: monospace;"></span><br><p>The following class diagram shows the classes of the model in its final version (Demo_Aquifer_5_rain.pcl): </p><imgalt="classDiag"src="../../images/applica/aquifer/classDiag.png"><h1>            </h1><h3>Version 1: "Demo_Aquifer.pcl"<span style="font-size: 14.000000pt; font-family: 'AdvOT863180fb'"></span></h3>            This is the simplest version. It contains only one class: Plot. It is a 10x10 grid. A quantity of 1400 m<sup>3</sup>/day is removed from cell #2 and put to cell 99#:&nbsp; <br><imgalt="grid v1"src="../../images/applica/aquifer/aquifer-v1.png"><br>                        <h3>Version 2: "Demo_Aquifer_2_transect.pcl"</h3>            <p>In this version, 2 classes have been added to display a vertical cross-section of the grid: Transect and CrossSectionChart. From the same initialisation of version 1, a transect is added from cell #11 to cell #100 and the cross-scetion is automatically displayed. The user can also add manually as many transects as he wants.<br>              <img alt="grid V2" src="../../images/applica/aquifer/aquifer-v2.png"><br>            </p>            <h3>Version 3: "Demo_Aquifer_3_riverWells.pcl"</h3><p>This version adds 3 classes: MonitoringWell (to monitor the local hydraulic head), PumpingWell (to pump water) and River. According to its head, the river may recharge or discharge the aquifers it crosses:</p><tablestyle="width: 100%;"border="0"><tbody><tr><td><imgalt="losingStream"src="../../images/applica/aquifer/GainingLosingStreams.png">&nbsp;&nbsp;&nbsp; </td><td><imgalt="V3"src="../../images/applica/aquifer/aquifer-v3.png"><br></td></tr></tbody></table><address>Gaining and losing streams. (a) Gaining stream; (b) losing              stream (from<span style="color: #0000ee;"> </span><a href="file:///Users/bommel/CormasWeb/en/applica/demoAquifer.html#Delleur">Delleur                1998</a>).</address>                                    <h3>Version 4: "Demo_Aquifer_4_autoCheck.pcl"</h3>            <p>A specific focus of the model development is the assessment of              stability and convergence. A correct choice of computational time step Δ<i>t</i> guarantees both              stability and accuracy. In order to avoid chessboard effects, the Reynolds number is adjusted so as to reduce the amplitude of the oscillations of a given cell.</p>            <img alt="oscillations" src="../../images/applica/aquifer/aquifer-v4.png"> <br>Example of auto-modification of D:<br><pre>' D = 1 =&gt; deltaT = 2000&nbsp; s - Daily repetition = 43 per day.'<br>' D = 0.9 =&gt; deltaT = 1666&nbsp; s - Daily repetition = 51 per day.'<br>' D = 0.8 =&gt; deltaT = 1760&nbsp; s - Daily repetition = 49 per day.'<br>' D = 0.801 =&gt; deltaT = 1790&nbsp; s - Daily repetition = 48 per day.'<br>' D = 0.802 =&gt; deltaT = 1615&nbsp; s - Daily repetition = 53 per day.'<br>' D = 0.803 =&gt; deltaT = 1652&nbsp; s - Daily repetition = 52 per day.'<br>' D = 0.804 =&gt; deltaT = 1797&nbsp; s - Daily repetition = 48 per day.'            </pre><h3>Version 5: "Demo_Aquifer_5_rain.pcl"</h3>            <p>Recharge of an aquifer usually refers to precipitation entering              from the ground to the water table. The Climate is updated and each cell&nbsp; rechargeByRain its aquifer, only once a day.</p>            <img alt="v5" src="../../images/applica/aquifer/aquifer-v5.png">            <pre>      </pre><h3>Version 6: "Demo_Aquifer_Ravazzani"</h3>            <p>The version 6 aims at verifying the tests described in the paper by Ravazzani et al. (2011). See <ahref="demoAquifer2.htm">all the tests here</a>.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------------------------------------------------------------------------------</p><p>The developed code is simple enough to facilitate its              integration into other models such as land-surface models with agents.</p><p><u>For more information, see </u></p>            <p><a name="reference"></a>Ravazzani, G., Rametta, D., &amp;              Mancini, M., 2011. Macroscopic cellular automata for groundwater              modelling: A first approach. Environmental Modelling &amp;              Software, 26(5), 634-643. <a href="http://www.academia.edu/4346234/Macroscopic_Cellular_Automata_for_groundwater_modelling">See paper on line</a></p>            <p>Jean Margat, Thierry Ruf, 2014. Les eaux souterraines sont-elles              éternelles&nbsp;? 90 clés pour comprendre les eaux souterraines.              Editions Quæ, <br>              ISSN 2261-3188 ISBN 978-2-7592-2192-9</p>            <p><a name="modFlow"></a>MODFLOW 6: Harbauch A W, 2005.              Modflow-2005, The U.S. Geological Survey Modular Ground-Water              Model, U.S. Geological Survey Techniques and Methods 6-A16              http://water.usgs.gov/nrp/gwsoftware/modflow2005/modflow2005.html            </p>            <p><a name="Delleur"></a>Jacques W. Delleur, 1998. Handbook of              Groundwater Engineering. Springer Science &amp; Business Media,              1998 - 949 p, ISBN&nbsp;&nbsp;&nbsp; 3540647457, 9783540647454<br>&nbsp;</p>            <ul>              <li>Download the model (<a href="../../logiciel/Demo_Aquifer.zip">zipfile</a>, 191Ko) </li>              <li>For more information, <a href="mailto:bommel@cirad.fr">contact                  the authors</a>.</li>            </ul>            <!--#include virtual="/include/copyright_en.inc" --> </td>          <td bgcolor="#FFFFFF" valign="top" width="15"> <br>          </td>        </tr>        <tr>          <td><br>          </td>          <td><br>          </td>          <td><br>          </td>        </tr>      </tbody>    </table></body></html>